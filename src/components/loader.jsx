import React, { useEffect } from "react";
import { gsap } from "gsap";
import { MorphSVGPlugin } from "gsap/MorphSVGPlugin";

gsap.registerPlugin(MorphSVGPlugin);

const PlantMorph = () => {
  useEffect(() => {
    gsap.defaults({ ease: "power3.inOut" });

    const tl = gsap.timeline({
      repeat: -1,
      yoyo: true,
      repeatDelay: 1.5,
    });

    const dur = 0.75;
    const dur2 = 0.25;

    // First transition: to sapling
    tl.to(
      "#leaf_stem",
      {
        duration: dur,
        morphSVG: "#sapling_stem",
      },
      "morphIt"
    )
      .to(
        "#leaf1",
        {
          duration: dur,
          morphSVG: "#sapling1",
        },
        "morphIt"
      )
      .to(
        "#leaf2",
        {
          duration: dur,
          morphSVG: "#sapling2",
        },
        "morphIt"
      )

      // Second transition: to plant - with staggered timing
      .to(
        "#leaf_stem",
        {
          duration: dur,
          morphSVG: "#plant_stem",
        },
        "plantMorph"
      )
      .to(
        "#leaf2",
        {
          duration: dur2,
          morphSVG: "#plant_leaf_top_right",
        },
        "plantMorph+=0.5" // Delay by 0.5 seconds from plantMorph label
      )
      .to(
        "#leaf1",
        {
          duration: dur2,
          morphSVG: "#plant_leaf_body_1",
        },
        "plantMorph+=0.8" // Delay by 0.5 seconds from plantMorph label
      );
  }, []);

  return (
    <div className=" bg-white flex flex-col justify-center items-center h-fit relative">
      <div className="w-40 h-40 rounded-full flex flex-col justify-center items-center relative">
        {/* Leaf SVG */}
        <div className="h-20 w-20 absolute m-auto inset-0" id="leaf_div">
          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlnsXlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 469.803 469.803" style={{ enableBackground: "new 0 0 400.174 600.174" }} xmlSpace="preserve">
            <g>
              <path
                id="leaf1"
                style={{ fill: "#45B549" }}
                d="M201.38,88.422c113.12-12.44,149.88-84,150-84c1.856-3.567,6.252-4.953,9.819-3.097
               c1.799,0.936,3.126,2.581,3.661,4.537c37.6,127.52,17.08,215.44-26.08,267.6c-16.709,20.331-38.11,36.296-62.36,46.52
               c-22.339,9.474-46.587,13.584-70.8,12c-46.36-3.24-88.68-28-108.32-72.36c-5.032-11.34-8.284-23.388-9.64-35.72
               c-2.743-24.717,2.083-49.685,13.84-71.6c12.622-23.385,32.719-41.863,57.08-52.48C172.173,93.833,186.611,89.988,201.38,88.422
               L201.38,88.422z"
              />
              <path
                id="leaf2"
                style={{ fill: "#45B549" }}
                d="M201.38,88.422c113.12-12.44,149.88-84,150-84c1.856-3.567,6.252-4.953,9.819-3.097
               c1.799,0.936,3.126,2.581,3.661,4.537c37.6,127.52,17.08,215.44-26.08,267.6c-16.709,20.331-38.11,36.296-62.36,46.52
               c-22.339,9.474-46.587,13.584-70.8,12c-46.36-3.24-88.68-28-108.32-72.36c-5.032-11.34-8.284-23.388-9.64-35.72
               c-2.743-24.717,2.083-49.685,13.84-71.6c12.622-23.385,32.719-41.863,57.08-52.48C172.173,93.833,186.611,89.988,201.38,88.422
               L201.38,88.422z"
              />
              <path
                id="leaf_stem"
                style={{ fill: "#009549" }}
                d="M350.58,7.102c0.099-4.019,3.437-7.198,7.456-7.099c4.019,0.099,7.198,3.437,7.099,7.456
               c-0.007,0.296-0.033,0.59-0.076,0.883c0,0.36-6.36,84-88,168.64l-0.76,0.8c-19.18,19.673-40.226,37.436-62.84,53.04l49.04,9.12
               c3.909,0.943,6.313,4.876,5.37,8.784c-0.854,3.538-4.189,5.902-7.81,5.536l-64-12c-58.36,36.96-157.28,71.08-165.92,151.6
               c-0.535,3.985-4.199,6.782-8.184,6.247c-3.793-0.509-6.544-3.868-6.296-7.687c10.32-96.52,108.4-121.36,174.56-163.56l0.92-0.6
               c26.403-16.71,50.861-36.311,72.92-58.44l-5.8-57.4c-0.535-3.985,2.262-7.649,6.247-8.184s7.649,2.262,8.184,6.247
               c0.022,0.165,0.039,0.331,0.049,0.497l4.4,44.56C345.18,79.142,350.54,7.422,350.58,7.102L350.58,7.102z"
              />
            </g>
          </svg>
        </div>

        {/* Sapling SVG (hidden by default) */}
        <div className="h-20 w-20 absolute m-auto inset-0 invisible" id="sapling_div">
          <svg version="1.1" id="sapling_svg" xmlns="http://www.w3.org/2000/svg" xmlnsXlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 469.803 469.803" style={{ enableBackground: "new 0 0 469.803 469.803" }} xmlSpace="preserve">
            <g>
              <g>
                <path
                  id="sapling1"
                  style={{ fill: "#4CAF50" }}
                  d="M188.864,67.349C147.819,26.325,67.499,21.568,10.667,21.568C4.776,21.568,0,26.344,0,32.235
                  c0,56.853,4.757,137.173,45.781,178.219c19.261,17.154,44.438,26.143,70.208,25.067c26.571,1.047,52.57-7.896,72.875-25.067
                  C219.435,179.861,225.045,103.531,188.864,67.349z"
                />
                <path
                  id="sapling2"
                  style={{ fill: "#4CAF50" }}
                  d="M459.136,63.765c-56.853,0-137.173,4.757-178.219,45.781c-36.267,36.267-30.571,112.491,0,143.083
                  c20.311,17.174,46.318,26.117,72.896,25.067c25.769,1.074,50.946-7.915,70.208-25.067c41.045-41.045,45.781-121.365,45.781-178.219
                  C469.791,68.528,465.019,63.765,459.136,63.765z"
                />
              </g>
              <path
                id="sapling_stem"
                style={{ fill: "#388E3C" }}
                d="M224,448.235c-5.891,0-10.667-4.776-10.667-10.667c0-226.24-82.965-283.008-114.197-304.363
               c-3.767-2.405-7.334-5.109-10.667-8.085c-4.093-4.237-3.975-10.99,0.262-15.083c4.134-3.993,10.687-3.993,14.821,0
               c2.409,2.037,4.961,3.898,7.637,5.568c27.733,18.965,93.056,63.659,115.648,210.261c17.459-76.645,69.213-140.995,140.331-174.485
               c5.446-2.562,11.946-0.51,14.933,4.715c2.698,4.755,1.032,10.796-3.723,13.495c-0.178,0.101-0.36,0.197-0.544,0.287l-1.728,0.811
               c-116.949,54.976-141.504,175.467-141.504,266.88C234.603,443.434,229.866,448.199,224,448.235z"
              />
            </g>
          </svg>
        </div>

        {/* Plant SVG (scaled + hidden) */}
        <div className="h-20 w-20 absolute m-auto inset-0 scale-[1.4] invisible" id="plant_div">
          <svg id="plant" viewBox="0 0 480.02557 480" xmlns="http://www.w3.org/2000/svg">
            <path id="plant_stem" d="m474.671875 232.453125-66.554687-23.289063c-26.558594-9.296874-55.746094-7.433593-80.910157 5.160157-25.160156 12.597656-44.144531 34.847656-52.617187 61.679687l-17.414063 55.144532-17.144531 12.855468v-115.160156c-.019531-15.347656 7.65625-29.6875 20.4375-38.183594l-8.878906-13.3125c-17.234375 11.464844-27.582032 30.796875-27.558594 51.496094v15.847656l-10.34375-10.34375-11.3125 11.3125 21.65625 21.65625v175.742188l-16-8v-16.457032c-.003906-40.242187-19.351562-78.035156-52-101.566406-32.652344-23.527344-74.621094-29.929687-112.800781-17.199218l-37.726563 12.574218c-3.285156 1.082032-5.503906 4.144532-5.503906 7.601563s2.21875 6.519531 5.503906 7.601562l8.566406 2.855469c41.0625 13.652344 79.378907 34.488281 113.160157 61.535156l67.800781 54.238282c.457031.320312.953125.589843 1.472656.800781l-.050781.105469 27.578125 13.800781v19.054687h16v-116l28.796875-21.601562-.085937-.109375c.328124-.191407.644531-.402344.945312-.632813 50.660156-50.496094 116.636719-82.765625 187.597656-91.753906l15.738282-1.964844c3.683593-.464844 6.5625-3.402344 6.957031-7.09375s-1.804688-7.167968-5.308594-8.394531zm0 0" fill="#3d7606" />
            <path id="plant_leaf_top_right" d="m307.78125 67.753906-3.75-60.246094c-.238281-3.789062-3.105469-6.890624-6.867188-7.4257808-3.75-.5000002-7.347656 1.6757808-8.644531 5.2343748l-25.875 72.414063c-9.675781 27.050781-14.621093 55.566406-14.613281 84.296875v21.976562c0 3.234375 1.949219 6.152344 4.9375 7.390625 2.988281 1.234375 6.429688.550781 8.71875-1.734375 32.132812-32.144531 48.921875-76.539062 46.09375-121.90625zm0 0" fill="#5fa819" />
            <path id="plant_leaf_body_1" d="m119.492188 106.050781-52.933594-17.597656c-2.734375-.914063-5.75-.285156-7.894532 1.644531-2.140624 1.933594-3.078124 4.867188-2.449218 7.683594l8.800781 39.695312c14.089844 64.769532 71.570313 110.851563 137.855469 110.527344h5.160156c4.417969 0 8-3.582031 8-8 .050781-60.789062-38.855469-114.769531-96.539062-133.953125zm0 0" fill="#5fa819" />
            <g fill="#589c17">
              <path id="plant_leaf_shadows" d="m158.828125 212.804688c-30.65625-18.867188-55.785156-45.492188-72.855469-77.183594l-25.230468-46.875c-3.488282 1.503906-5.398438 5.292968-4.527344 8.992187l8.800781 39.695313c14.074219 64.789062 71.558594 110.890625 137.855469 110.570312h5.160156c1.820312-.03125 3.570312-.691406 4.957031-1.871094zm0 0" />
              <path id="plant_leaf_bottom_right" d="m329.773438 269.601562c-16.855469 12.035157-30.179688 28.363282-38.589844 47.289063l-3.699219 8.320313c48.023437-41.164063 107.054687-67.351563 169.800781-75.320313l15.242188-1.886719h-75.3125c-24.183594-.007812-47.761719 7.546875-67.441406 21.597656zm0 0" />
              <path id="plant_leaf_bottom_left" d="m204.222656 451.042969-.160156-.878907c-15.910156-87.515624-95.550781-148.734374-184.214844-141.601562l-3.722656.296875-10.621094 3.542969c-3.285156 1.082031-5.503906 4.144531-5.503906 7.601562 0 3.457032 2.21875 6.519532 5.503906 7.597656l8.566406 2.859376c41.0625 13.65625 79.378907 34.492187 113.160157 61.542968l67.800781 54.238282c.457031.320312.953125.589843 1.472656.800781l-.050781.105469zm0 0" />
            </g>
          </svg>
        </div>
      </div>
    </div>
  );
};

export default PlantMorph;
